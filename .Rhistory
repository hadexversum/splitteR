filter(Start.x == 5, End.x == 11)  %>%
ggplot(.) +
geom_point(aes(x = Exposure, y = avg_exp_mass.x), color = "red") +
geom_point(aes(x = Exposure, y = avg_exp_mass.y), color = "blue") +
geom_point(aes(x = Exposure, y = mass), color = "black") +
lim(y = c(0, NA))
res_uc %>%
filter(Start.x == 5, End.x == 11)  %>%
ggplot(.) +
geom_point(aes(x = Exposure, y = avg_exp_mass.x), color = "red") +
geom_point(aes(x = Exposure, y = avg_exp_mass.y), color = "blue") +
geom_point(aes(x = Exposure, y = mass), color = "black") +
lims(y = c(0, NA))
longer_dat_mass
merge(longer_dat_mass, shorter_dat_mass, by = c("Protein", "Modification", "State", "Exposure", "File")) %>%
select( -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
mutate(mass = avg_exp_mass.x - avg_exp_mass.y) %>%
mutate(MaxUptake = 1,
MHP = 1)
merge(longer_dat_mass, shorter_dat_mass, by = c("Protein", "Modification", "State", "Exposure", "File")) %>%
select( -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
mutate(mass = avg_exp_mass.x - avg_exp_mass.y) %>%
mutate(MaxUptake = 1,
MHP = 1,
Start = sub_start,
End = sub_end,
z = 1)
merge(longer_dat_mass, shorter_dat_mass, by = c("Protein", "Modification", "State", "Exposure", "File")) %>%
select( -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
mutate(mass = avg_exp_mass.x - avg_exp_mass.y) %>%
mutate(MaxUptake = 1,
MHP = 1,
Start = sub_start,
End = sub_end,
z = 1) %>%
select(-Start.x, -End.x, -Start.y, -End.y)
merge(longer_dat_mass, shorter_dat_mass, by = c("Protein", "Modification", "State", "Exposure", "File")) %>%
select( -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
mutate(mass = avg_exp_mass.x - avg_exp_mass.y) %>%
mutate(MaxUptake = 1,
MHP = 1,
Start = sub_start,
End = sub_end,
z = 1) %>%
select(-Start.x, -End.x, -Start.y, -End.y, -avg_exp_mass.x, -avg_exp_mass.y)
merge(longer_dat_mass, shorter_dat_mass, by = c("Protein", "Modification", "State", "Exposure", "File")) %>%
select( -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
mutate(mass = avg_exp_mass.x - avg_exp_mass.y) %>%
mutate(MaxUptake = 1,
MHP = 1,
Start = sub_start,
End = sub_end,
z = 1) %>%
select(-Start.x, -End.x, -Start.y, -End.y, -avg_exp_mass.x, -avg_exp_mass.y) %>%
rename(Center = mass)
merge(longer_dat_mass, shorter_dat_mass, by = c("Protein", "Modification", "State", "Exposure", "File")) %>%
select( -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
mutate(mass = avg_exp_mass.x - avg_exp_mass.y) %>%
mutate(MaxUptake = 1,
MHP = 1,
Start = sub_start,
End = sub_end,
z = 1,
Inten = 1) %>%
select(-Start.x, -End.x, -Start.y, -End.y, -avg_exp_mass.x, -avg_exp_mass.y) %>%
rename(Center = mass)
res_uc <- lapply(1:nrow(res_dat), function(i){
sub_start = res_dat[i, "sub_start"]
sub_end = res_dat[i, "sub_end"]
longer_peptide <- peptides[peptides[["id"]] == res_dat[i, "longer_id"]]
shorter_peptide <- peptides[peptides[["id"]] == res_dat[i, "shorter_id"]]
## with z
# longer_dat <- merge(dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# shorter_dat <- merge(dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# merge(longer_dat, shorter_dat, by = c("Protein", "Modification", "State", "Exposure", "File", "z")) %>%
#   select(-Protein, -Modification, -State, -Exposure, -File, -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
#   select(z, Inten.x, Center.x, Inten.y, Center.y) %>%
#   mutate(mass.x = Center.x*z, mass.y = Center.y*z) %>%
#   mutate(mass = mass.x - mass.y)
## without z
# uc_3 <-
lapply(times, function(time){
longer_dat_mass <- merge(mass_dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
shorter_dat_mass <- merge(mass_dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
merge(longer_dat_mass, shorter_dat_mass, by = c("Protein", "Modification", "State", "Exposure", "File")) %>%
select( -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
mutate(mass = avg_exp_mass.x - avg_exp_mass.y) %>%
mutate(MaxUptake = 1,
MHP = 1,
Start = sub_start,
End = sub_end,
z = 1,
Inten = 1) %>%
select(-Start.x, -End.x, -Start.y, -End.y, -avg_exp_mass.x, -avg_exp_mass.y) %>%
rename(Center = mass)
}) %>% bind_rows()
}) %>% bind_rows()
res_uc
res_uc %>%
filter(Center<0)
?write.csv
write.csv(res_uc, file = "prepared_data.csv")
str(res_uc)
res_uc <- lapply(1:nrow(res_dat), function(i){
sub_start = res_dat[i, "sub_start"]
sub_end = res_dat[i, "sub_end"]
sub_sequence = res_dat[i, "sub_sequence"]
longer_peptide <- peptides[peptides[["id"]] == res_dat[i, "longer_id"]]
shorter_peptide <- peptides[peptides[["id"]] == res_dat[i, "shorter_id"]]
## with z
# longer_dat <- merge(dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# shorter_dat <- merge(dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# merge(longer_dat, shorter_dat, by = c("Protein", "Modification", "State", "Exposure", "File", "z")) %>%
#   select(-Protein, -Modification, -State, -Exposure, -File, -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
#   select(z, Inten.x, Center.x, Inten.y, Center.y) %>%
#   mutate(mass.x = Center.x*z, mass.y = Center.y*z) %>%
#   mutate(mass = mass.x - mass.y)
## without z
# uc_3 <-
lapply(times, function(time){
longer_dat_mass <- merge(mass_dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
shorter_dat_mass <- merge(mass_dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
merge(longer_dat_mass, shorter_dat_mass, by = c("Protein", "Modification", "State", "Exposure", "File")) %>%
select( -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
mutate(mass = avg_exp_mass.x - avg_exp_mass.y) %>%
mutate(MaxUptake = 1,
MHP = 1,
Start = sub_start,
End = sub_end,
Sequence = sub_sequence,
z = 1,
Inten = 1) %>%
select(-Start.x, -End.x, -Start.y, -End.y, -avg_exp_mass.x, -avg_exp_mass.y) %>%
rename(Center = mass)
}) %>% bind_rows()
}) %>% bind_rows()
res_uc %>%
filter(Center<0)
write.csv(res_uc, file = "prepared_data.csv")
res_uc <- lapply(1:nrow(res_dat), function(i){
sub_start = res_dat[i, "sub_start"]
sub_end = res_dat[i, "sub_end"]
sub_sequence = res_dat[i, "sub_sequence"]
longer_peptide <- peptides[peptides[["id"]] == res_dat[i, "longer_id"]]
shorter_peptide <- peptides[peptides[["id"]] == res_dat[i, "shorter_id"]]
## with z
# longer_dat <- merge(dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# shorter_dat <- merge(dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# merge(longer_dat, shorter_dat, by = c("Protein", "Modification", "State", "Exposure", "File", "z")) %>%
#   select(-Protein, -Modification, -State, -Exposure, -File, -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
#   select(z, Inten.x, Center.x, Inten.y, Center.y) %>%
#   mutate(mass.x = Center.x*z, mass.y = Center.y*z) %>%
#   mutate(mass = mass.x - mass.y)
## without z
# uc_3 <-
lapply(times, function(time){
longer_dat_mass <- merge(mass_dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
shorter_dat_mass <- merge(mass_dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
merge(longer_dat_mass, shorter_dat_mass, by = c("Protein", "Modification", "State", "Exposure", "File")) %>%
select( -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
mutate(mass = avg_exp_mass.x - avg_exp_mass.y) %>%
mutate(MaxUptake = 1,
MHP = 1,
Start = sub_start,
End = sub_end,
Sequence = sub_sequence,
Fragment = "",
z = 1,
RT = 1,
Inten = 1) %>%
select(-Start.x, -End.x, -Start.y, -End.y, -avg_exp_mass.x, -avg_exp_mass.y) %>%
rename(Center = mass)
}) %>% bind_rows()
}) %>% bind_rows()
write.csv(res_uc, file = "prepared_data.csv")
write.csv(res_uc, file = "prepared_data.csv", row.names = FALSE)
res_dat
i = 4
sub_start = res_dat[i, "sub_start"]
sub_end = res_dat[i, "sub_end"]
sub_sequence = res_dat[i, "sub_sequence"]
sub_start
sub_end
sub_sequence
longer_peptide <- peptides[peptides[["id"]] == res_dat[i, "longer_id"]]
shorter_peptide <- peptides[peptides[["id"]] == res_dat[i, "shorter_id"]]
longer_peptide
nrow(longer_peptide) == 0
if(nrow(longer_peptide) == 0 & nrow(shorter_peptide) == 0)
nrow(longer_peptide) == 0 & nrow(shorter_peptide) == 0
origin_dat <- filter(mass_dat, Start == sub_start, End == sub_end)
origin_dat
res_uc <- lapply(1:nrow(res_dat), function(i){
sub_start = res_dat[i, "sub_start"]
sub_end = res_dat[i, "sub_end"]
sub_sequence = res_dat[i, "sub_sequence"]
longer_peptide <- peptides[peptides[["id"]] == res_dat[i, "longer_id"]]
shorter_peptide <- peptides[peptides[["id"]] == res_dat[i, "shorter_id"]]
## with z
# longer_dat <- merge(dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# shorter_dat <- merge(dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# merge(longer_dat, shorter_dat, by = c("Protein", "Modification", "State", "Exposure", "File", "z")) %>%
#   select(-Protein, -Modification, -State, -Exposure, -File, -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
#   select(z, Inten.x, Center.x, Inten.y, Center.y) %>%
#   mutate(mass.x = Center.x*z, mass.y = Center.y*z) %>%
#   mutate(mass = mass.x - mass.y)
## without z
# uc_3 <-
lapply(times, function(time){
if(nrow(longer_peptide) == 0 & nrow(shorter_peptide) == 0){
origin_dat <- filter(mass_dat, Start == sub_start, End == sub_end) %>%
rename(Center = ang_exp_mass) %>%
mutate(Fragment = "",
z = 1,
RT = 1,
Inten = 1)
} else {
longer_dat_mass <- merge(mass_dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
shorter_dat_mass <- merge(mass_dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
merge(longer_dat_mass, shorter_dat_mass, by = c("Protein", "Modification", "State", "Exposure", "File")) %>%
select( -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
mutate(mass = avg_exp_mass.x - avg_exp_mass.y) %>%
mutate(MaxUptake = 1,
MHP = 1,
Start = sub_start,
End = sub_end,
Sequence = sub_sequence,
Fragment = "",
z = 1,
RT = 1,
Inten = 1) %>%
select(-Start.x, -End.x, -Start.y, -End.y, -avg_exp_mass.x, -avg_exp_mass.y) %>%
rename(Center = mass)
}
}) %>% bind_rows()
}) %>% bind_rows()
res_uc <- lapply(1:nrow(res_dat), function(i){
sub_start = res_dat[i, "sub_start"]
sub_end = res_dat[i, "sub_end"]
sub_sequence = res_dat[i, "sub_sequence"]
longer_peptide <- peptides[peptides[["id"]] == res_dat[i, "longer_id"]]
shorter_peptide <- peptides[peptides[["id"]] == res_dat[i, "shorter_id"]]
## with z
# longer_dat <- merge(dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# shorter_dat <- merge(dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# merge(longer_dat, shorter_dat, by = c("Protein", "Modification", "State", "Exposure", "File", "z")) %>%
#   select(-Protein, -Modification, -State, -Exposure, -File, -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
#   select(z, Inten.x, Center.x, Inten.y, Center.y) %>%
#   mutate(mass.x = Center.x*z, mass.y = Center.y*z) %>%
#   mutate(mass = mass.x - mass.y)
## without z
# uc_3 <-
lapply(times, function(time){
if(nrow(longer_peptide) == 0 & nrow(shorter_peptide) == 0){
origin_dat <- filter(mass_dat, Start == sub_start, End == sub_end) %>%
rename(Center = avg_exp_mass) %>%
mutate(Fragment = "",
z = 1,
RT = 1,
Inten = 1)
} else {
longer_dat_mass <- merge(mass_dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
shorter_dat_mass <- merge(mass_dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
merge(longer_dat_mass, shorter_dat_mass, by = c("Protein", "Modification", "State", "Exposure", "File")) %>%
select( -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
mutate(mass = avg_exp_mass.x - avg_exp_mass.y) %>%
mutate(MaxUptake = 1,
MHP = 1,
Start = sub_start,
End = sub_end,
Sequence = sub_sequence,
Fragment = "",
z = 1,
RT = 1,
Inten = 1) %>%
select(-Start.x, -End.x, -Start.y, -End.y, -avg_exp_mass.x, -avg_exp_mass.y) %>%
rename(Center = mass)
}
}) %>% bind_rows()
}) %>% bind_rows()
res_uc %>%
filter(Center<0)
res_uc %>%
select(Sequence, Start, End) %>%
unique(.)
write.csv(res_uc, file = "prepared_data.csv", row.names = FALSE)
dat <- filter(alpha_dat, State == "Alpha_KSCN")
mass_dat <- HaDeX::calculate_exp_masses_per_replicate(dat)
times <- unique(mass_dat[["Exposure"]])
res_uc <- lapply(1:nrow(res_dat), function(i){
sub_start = res_dat[i, "sub_start"]
sub_end = res_dat[i, "sub_end"]
sub_sequence = res_dat[i, "sub_sequence"]
longer_peptide <- peptides[peptides[["id"]] == res_dat[i, "longer_id"]]
shorter_peptide <- peptides[peptides[["id"]] == res_dat[i, "shorter_id"]]
## with z
# longer_dat <- merge(dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# shorter_dat <- merge(dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# merge(longer_dat, shorter_dat, by = c("Protein", "Modification", "State", "Exposure", "File", "z")) %>%
#   select(-Protein, -Modification, -State, -Exposure, -File, -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
#   select(z, Inten.x, Center.x, Inten.y, Center.y) %>%
#   mutate(mass.x = Center.x*z, mass.y = Center.y*z) %>%
#   mutate(mass = mass.x - mass.y)
## without z
# uc_3 <-
lapply(times, function(time){
if(nrow(longer_peptide) == 0 & nrow(shorter_peptide) == 0){
origin_dat <- filter(mass_dat, Start == sub_start, End == sub_end) %>%
rename(Center = avg_exp_mass) %>%
mutate(Fragment = "",
z = 1,
RT = 1,
Inten = 1)
} else {
longer_dat_mass <- merge(mass_dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
shorter_dat_mass <- merge(mass_dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
merge(longer_dat_mass, shorter_dat_mass, by = c("Protein", "Modification", "State", "Exposure", "File")) %>%
select( -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
mutate(mass = avg_exp_mass.x - avg_exp_mass.y) %>%
mutate(MaxUptake = 1,
MHP = 1,
Start = sub_start,
End = sub_end,
Sequence = sub_sequence,
Fragment = "",
z = 1,
RT = 1,
Inten = 1) %>%
select(-Start.x, -End.x, -Start.y, -End.y, -avg_exp_mass.x, -avg_exp_mass.y) %>%
rename(Center = mass)
}
}) %>% bind_rows()
}) %>% bind_rows()
res_uc %>%
filter(Center<0)
res_dat <- data.frame(
sub_sequence = c("YL", "AD", "K", "S", "Y", "IEG", "YVPSQAD"),
sub_start = c(17, 19, 21, 22, 23, 24, 27),
sub_end = c(19, 21, 22, 23, 24, 27, 33),
common = c("end", "end", "end", "end", "end", "end", "origin"),
longer_id = c(NA, 22, 21, 18, 17, 15, 14),
shorter_id = c(NA, 21, 18, 17, 15, 14, 13),
level = c(6, 6, 6, 6, 6, 6, 6)
)
res_uc <- lapply(1:nrow(res_dat), function(i){
sub_start = res_dat[i, "sub_start"]
sub_end = res_dat[i, "sub_end"]
sub_sequence = res_dat[i, "sub_sequence"]
longer_peptide <- peptides[peptides[["id"]] == res_dat[i, "longer_id"]]
shorter_peptide <- peptides[peptides[["id"]] == res_dat[i, "shorter_id"]]
## with z
# longer_dat <- merge(dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# shorter_dat <- merge(dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# merge(longer_dat, shorter_dat, by = c("Protein", "Modification", "State", "Exposure", "File", "z")) %>%
#   select(-Protein, -Modification, -State, -Exposure, -File, -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
#   select(z, Inten.x, Center.x, Inten.y, Center.y) %>%
#   mutate(mass.x = Center.x*z, mass.y = Center.y*z) %>%
#   mutate(mass = mass.x - mass.y)
## without z
# uc_3 <-
lapply(times, function(time){
if(nrow(longer_peptide) == 0 & nrow(shorter_peptide) == 0){
origin_dat <- filter(mass_dat, Start == sub_start, End == sub_end) %>%
rename(Center = avg_exp_mass) %>%
mutate(Fragment = "",
z = 1,
RT = 1,
Inten = 1)
} else {
longer_dat_mass <- merge(mass_dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
shorter_dat_mass <- merge(mass_dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
merge(longer_dat_mass, shorter_dat_mass, by = c("Protein", "Modification", "State", "Exposure", "File")) %>%
select( -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
mutate(mass = avg_exp_mass.x - avg_exp_mass.y) %>%
mutate(MaxUptake = 1,
MHP = 1,
Start = sub_start,
End = sub_end,
Sequence = sub_sequence,
Fragment = "",
z = 1,
RT = 1,
Inten = 1) %>%
select(-Start.x, -End.x, -Start.y, -End.y, -avg_exp_mass.x, -avg_exp_mass.y) %>%
rename(Center = mass)
}
}) %>% bind_rows()
}) %>% bind_rows()
res_uc %>%
filter(Center<0)
res_1 <- data.frame(
sub_sequence = c("G", "F", "GD", "LKSPAG", "L", "AGLQVL", "QVLND", "Y"),
sub_start = c(1, 2, 3, 5, 10, 9, 12, 16),
sub_end = c(2, 3, 5, 10, 11, 14, 16, 17),
common = c("end", "end", "end", "origin", "start", "origin", "origin", "start"),
longer_id = c(1, 2, 3, NA, 5, NA, NA, 8),
shorter_id = c(2, 3, 5, NA, 4, NA, NA, 7),
level = c(1, 1, 1, 1, 1, 2, 1, 1)
)
res_2 <- data.frame(
sub_sequence = c("NDYLAD", "K", "YLADKS", "Y", "IEGYVPSQAD", "SYIEG", "YVPSQAD", "IEGYVP", "SQA", "D"),
sub_start = c(15, 20, 17, 22, 23, 22, 26, 24, 29, 32),
sub_end = c(20, 21, 22, 23, 33, 26, 33, 29, 32, 33),
common = c("origin", "start", "origin", "start", "start", "origin", "start", "origin", "start", "start"),
longer_id = c(NA, 10, NA, 12, 13, NA, 17, NA, 21, 20),
shorter_id = c(NA, 9, NA, 11, 12, NA, 16, NA, 19, 20),
level = c(2, 2, 3, 3, 3, 4, 4, 5, 5, 5)
)
res_3 <- data.frame(
sub_sequence = c("YL", "AD", "K", "S", "Y", "IEG", "YVPSQAD"),
sub_start = c(17, 19, 21, 22, 23, 24, 27),
sub_end = c(19, 21, 22, 23, 24, 27, 33),
common = c("end", "end", "end", "end", "end", "end", "origin"),
longer_id = c(NA, 22, 21, 18, 17, 15, 14),
shorter_id = c(NA, 21, 18, 17, 15, 14, 13),
level = c(6, 6, 6, 6, 6, 6, 6)
)
res_dat <- bind_rows(res_1, res_2, res_3)
res_uc <- lapply(1:nrow(res_dat), function(i){
sub_start = res_dat[i, "sub_start"]
sub_end = res_dat[i, "sub_end"]
sub_sequence = res_dat[i, "sub_sequence"]
longer_peptide <- peptides[peptides[["id"]] == res_dat[i, "longer_id"]]
shorter_peptide <- peptides[peptides[["id"]] == res_dat[i, "shorter_id"]]
## with z
# longer_dat <- merge(dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# shorter_dat <- merge(dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
#   filter(Exposure == 5)
#
# merge(longer_dat, shorter_dat, by = c("Protein", "Modification", "State", "Exposure", "File", "z")) %>%
#   select(-Protein, -Modification, -State, -Exposure, -File, -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
#   select(z, Inten.x, Center.x, Inten.y, Center.y) %>%
#   mutate(mass.x = Center.x*z, mass.y = Center.y*z) %>%
#   mutate(mass = mass.x - mass.y)
## without z
# uc_3 <-
lapply(times, function(time){
if(nrow(longer_peptide) == 0 & nrow(shorter_peptide) == 0){
origin_dat <- filter(mass_dat, Start == sub_start, End == sub_end) %>%
rename(Center = avg_exp_mass) %>%
mutate(Fragment = "",
z = 1,
RT = 1,
Inten = 1)
} else {
longer_dat_mass <- merge(mass_dat, longer_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
shorter_dat_mass <- merge(mass_dat, shorter_peptide, by = c("Sequence", "Start", "End")) %>%
filter(Exposure == time)
merge(longer_dat_mass, shorter_dat_mass, by = c("Protein", "Modification", "State", "Exposure", "File")) %>%
select( -MaxUptake.x, -MaxUptake.y, - Sequence.x, -Sequence.y, -MHP.x, -MHP.y, -id.x, -id.y) %>%
mutate(mass = avg_exp_mass.x - avg_exp_mass.y) %>%
mutate(MaxUptake = 1,
MHP = 1,
Start = sub_start,
End = sub_end,
Sequence = sub_sequence,
Fragment = "",
z = 1,
RT = 1,
Inten = 1) %>%
select(-Start.x, -End.x, -Start.y, -End.y, -avg_exp_mass.x, -avg_exp_mass.y) %>%
rename(Center = mass)
}
}) %>% bind_rows()
}) %>% bind_rows()
write.csv(res_uc, file = "prepared_data.csv", row.names = FALSE)
library(splitteR)
